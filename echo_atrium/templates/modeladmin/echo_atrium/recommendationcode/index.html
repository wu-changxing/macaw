{% extends "wagtailadmin/base.html" %}
{% load i18n wagtailadmin_tags %}

{% block extra_css %}
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.17/dist/tailwind.min.css" rel="stylesheet">
{% endblock %}

{% block titletag %}{% trans "Recommendation Codes" %}{% endblock %}

{% block content %}
    <header class="py-4 px-8 bg-gray-100">
        <div class="flex justify-between items-center">
            <h1 class="text-2xl font-semibold">{% trans "Recommendation Codes" %}</h1>
            <div class="flex items-center">
                <form class="flex items-center" action="." method="GET" novalidate>
                    <input type="text" name="q" placeholder="{% trans 'Search codes and usernames' %}"
                           value="{{ search_query|default:'' }}"
                           class="border border-gray-300 px-3 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"/>
                    <button type="submit"
                            class="ml-2 text-white bg-indigo-500 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">{% trans 'Search' %}</button>
                </form>
            </div>
        </div>
    </header>

    <div class="w-full max-w-lg p-8 space-y-4 text-left bg-white rounded-xl shadow-lg mx-28">
        <h3 class="text-lg font-semibold">{% trans 'Add Recommendation Code' %}</h3>
        <form method="POST" action="{% url 'add_recommendation_code' %}">
            {% csrf_token %}
            <div class="space-y-4">
                <div>
                    <label for="code" class="block text-sm font-medium text-gray-700">{% trans 'Code' %}</label>
                    <input id="code" name="code" type="text" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div>
                    <label for="user" class="block text-sm font-medium text-gray-700">{% trans 'User' %}</label>
                    <input id="user" name="user" type="text" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
            </div>
            <div class="flex justify-end mt-4">
                <button type="submit"
                        class="text-white w-full h-16 bg-indigo-500 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">{% trans 'Add' %}</button>
            </div>
        </form>
    </div>

    <table class="min-w-full divide-y divide-gray-200 mt-4">
        <thead class="bg-gray-50">
        <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{% trans "Code" %}</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{% trans "User" %}</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{% trans "Created At" %}</th>
        </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
        {% for recommendation_code in recommendation_codes %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap">{{ recommendation_code.code }}</td>
                <td class="px-6 py-4 whitespace-nowrap">{{ recommendation_code.user.username }}</td>
                <td class="px-6 py-4 whitespace-nowrap">{{ recommendation_code.created_at|date:'Y-m-d H:i:s' }}</td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="3" class="px-6 py-4 whitespace-nowrap">{% trans "No recommendation codes found." %}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% include "wagtailadmin/shared/pagination_nav.html" with items=recommendation_codes %}
{% endblock %}
{% block extra_js %}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('add-code-button').addEventListener('click', function () {
                document.getElementById('add-code-modal').classList.remove('hidden');
            });

            document.getElementById('cancel-button').addEventListener('click', function () {
                document.getElementById('add-code-modal').classList.add('hidden');
            });
        });
    </script>
{% endblock %}

